<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <script type="application/javascript" src='https://cyilin36.github.io/js/theme-mode.js'></script>
    <link rel="stylesheet" href='https://cyilin36.github.io/css/frameworks.min.css' />
    <link rel="stylesheet" href='https://cyilin36.github.io/css/github.min.css' />
    <link rel="stylesheet" href='https://cyilin36.github.io/css/github-style.css' />
    <link rel="stylesheet" href='https://cyilin36.github.io/css/light.css' />
    <link rel="stylesheet" href='https://cyilin36.github.io/css/dark.css' />
    <link rel="stylesheet" href='https://cyilin36.github.io/css/syntax.css' />
    <title>稍微剑走偏锋的nas方案——1 - cyilin&#39;s blog</title>
    
    <link rel="icon" type="image/x-icon" href='/images/favicon.png'>
    
    <meta name="theme-color" content="#1e2327">

    
    

    
    <meta name="description"
  content="我要给小姐姐一个温暖的家" />
<meta name="keywords"
  content='' />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://cyilin36.github.io/post/%E7%A8%8D%E5%BE%AE%E5%89%91%E8%B5%B0%E5%81%8F%E9%94%8B%E7%9A%84nas%E6%96%B9%E6%A1%881/" />


<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="稍微剑走偏锋的nas方案——1 - cyilin&#39;s blog" />
<meta name="twitter:description"
  content="我要给小姐姐一个温暖的家" />
<meta name="twitter:site" content="https://cyilin36.github.io/" />
<meta name="twitter:creator" content="" />
<meta name="twitter:image"
  content="https://cyilin36.github.io/">


<meta property="og:type" content="article" />
<meta property="og:title" content="稍微剑走偏锋的nas方案——1 - cyilin&#39;s blog">
<meta property="og:description"
  content="我要给小姐姐一个温暖的家" />
<meta property="og:url" content="https://cyilin36.github.io/post/%E7%A8%8D%E5%BE%AE%E5%89%91%E8%B5%B0%E5%81%8F%E9%94%8B%E7%9A%84nas%E6%96%B9%E6%A1%881/" />
<meta property="og:site_name" content="稍微剑走偏锋的nas方案——1" />
<meta property="og:image"
  content="https://cyilin36.github.io/">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta property="article:published_time" content="2024-12-28 20:32:08 &#43;0800 CST" />











</head>


<body>
  <div style="position: relative">
  <header class="Header js-details-container Details px-3 px-md-4 px-lg-5 flex-wrap flex-md-nowrap open Details--on">
    <div class="Header-item mobile-none" style="margin-top: -4px; margin-bottom: -4px;">
      <a class="Header-link" href="https://cyilin36.github.io/">
        <img class="octicon" height="32" width="32" src="/images/avatar.png">
      </a>
    </div>
    <div class="Header-item d-md-none">
      <button class="Header-link btn-link js-details-target" type="button"
        onclick="document.querySelector('#header-search').style.display = document.querySelector('#header-search').style.display == 'none'? 'block': 'none'">
        <svg height="24" class="octicon octicon-three-bars" viewBox="0 0 16 16" version="1.1" width="24">
          <path fill-rule="evenodd" d="M1 2.75A.75.75 0 011.75 2h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 2.75zm0 5A.75.75 0 011.75 7h12.5a.75.75 0 110 1.5H1.75A.75.75 0 011 7.75zM1.75 12a.75.75 0 100 1.5h12.5a.75.75 0 100-1.5H1.75z">
          </path>
        </svg>
      </button>
    </div>
    <div style="display: none;" id="header-search"
      class="Header-item Header-item--full flex-column flex-md-row width-full flex-order-2 flex-md-order-none mr-0 mr-md-3 mt-3 mt-md-0 Details-content--hidden-not-important d-md-flex">
      <div
        class="Header-search header-search flex-auto js-site-search position-relative flex-self-stretch flex-md-self-auto mb-3 mb-md-0 mr-0 mr-md-3 scoped-search site-scoped-search js-jump-to">
        <div class="position-relative">
          
          <form target="_blank" id="search-form" action="" accept-charset="UTF-8" method="get"
            autocomplete="off">
            <label
              class="Header-search-label form-control input-sm header-search-wrapper p-0 js-chromeless-input-container header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center">
              <input type="text"
                class="Header-search-input form-control input-sm header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable"
                name="q" value="" placeholder="Search" autocomplete="off">
            </label>
          </form>
          
        </div>
      </div>
    </div>

    <div class="Header-item Header-item--full flex-justify-center d-md-none position-relative">
      <a class="Header-link " href="https://cyilin36.github.io/">
        <img class="octicon octicon-mark-github v-align-middle" height="32" width="32" src="/images/avatar.png">
      </a>
    </div>
    <div class="Header-item" style="margin-right: 0;">
      <a href="javascript:void(0)" class="Header-link no-select" onclick="switchTheme()">
        <svg style="fill: var(--color-profile-color-modes-toggle-moon);" class="no-select" viewBox="0 0 16 16"
          version="1.1" width="16" height="16">
          <path fill-rule="evenodd" clip-rule="evenodd"
            d="M4.52208 7.71754C7.5782 7.71754 10.0557 5.24006 10.0557 2.18394C10.0557 1.93498 10.0392 1.68986 10.0074 1.44961C9.95801 1.07727 10.3495 0.771159 10.6474 0.99992C12.1153 2.12716 13.0615 3.89999 13.0615 5.89383C13.0615 9.29958 10.3006 12.0605 6.89485 12.0605C3.95334 12.0605 1.49286 10.001 0.876728 7.24527C0.794841 6.87902 1.23668 6.65289 1.55321 6.85451C2.41106 7.40095 3.4296 7.71754 4.52208 7.71754Z">
          </path>
        </svg>
      </a>
    </div>
  </header>
</div>

  <div id="search-result" class="container-lg px-3 new-discussion-timeline" style="display: none;">
</div>

  
<div class="application-main">
  <div>
  <main>
    <div class="gisthead pagehead bg-gray-light pb-0 pt-3 mb-4">
      <div class="px-0">
        <div class="mb-3 d-flex px-3 px-md-3 px-lg-5">
          <div class="flex-auto min-width-0 width-fit mr-3">
            <div class="d-flex">
              <div class="d-none d-md-block">
                <a class="avatar mr-2 flex-shrink-0" href="https://cyilin36.github.io/">
                  <img class=" avatar-user"
                    src="/images/avatar.png"
                    width="32" height="32"></a>
              </div>
              <div class="d-flex flex-column">
                <h1 class="break-word f3 text-normal mb-md-0 mb-1">
                  <span class="author">
                    <a href="https://cyilin36.github.io/">cyilin</a>
                  </span>
                  <span class="path-divider">/</span>
                  <strong class="css-truncate css-truncate-target mr-1" style="max-width: 410px">
                    <a href="https://cyilin36.github.io/post/%E7%A8%8D%E5%BE%AE%E5%89%91%E8%B5%B0%E5%81%8F%E9%94%8B%E7%9A%84nas%E6%96%B9%E6%A1%881/">稍微剑走偏锋的nas方案——1</a>
                  </strong>
                </h1>
                <div class="note m-0">
                  Created <relative-time datetime="Sat, 28 Dec 2024 20:32:08 &#43;0800"
                    class="no-wrap">
                    Sat, 28 Dec 2024 20:32:08 &#43;0800</relative-time>

                  
                  <span class="file-info-divider"></span>
                  Modified <relative-time datetime="Wed, 24 Sep 2025 01:15:09 &#43;0800"
                    class="no-wrap">
                    Wed, 24 Sep 2025 01:15:09 &#43;0800</relative-time>
                  
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container-lg px-3 new-discussion-timeline">
      <div class="repository-content gist-content">
        <div>
          <div class="js-gist-file-update-container js-task-list-container file-box">
            <div id="file-pytest" class="file my-2">
              <div id="post-header" class="file-header d-flex flex-md-items-center flex-items-start sticky-header" style="z-index: 2">
                <div class="file-info d-flex flex-md-items-center flex-items-start flex-order-1 flex-auto">
                  <div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0">
                    
                    <summary id="toc-toggle" onclick="clickToc()" class="btn btn-octicon m-0 mr-2 p-2">
                      <svg aria-hidden="true" viewBox="0 0 16 16" height="16" width="16" class="octicon octicon-list-unordered">
                        <path fill-rule="evenodd" d="M2 4a1 1 0 100-2 1 1 0 000 2zm3.75-1.5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zm0 5a.75.75 0 000 1.5h8.5a.75.75 0 000-1.5h-8.5zM3 8a1 1 0 11-2 0 1 1 0 012 0zm-1 6a1 1 0 100-2 1 1 0 000 2z"></path>
                      </svg>
                    </summary>
                    <details-menu class="SelectMenu" id="toc-details" style="display: none;">
                      <div class="SelectMenu-modal rounded-3 mt-1" style="max-height: 340px;">
                        <div class="SelectMenu-list SelectMenu-list--borderless p-2" style="overscroll-behavior: contain;" id="toc-list">
                        </div>
                      </div>
                    </details-menu>
                      2973 Words
                    

                  </div>
                  <div class="file-actions flex-order-2 pt-0">
                    
                  </div>
                </div>
              </div>


              <div class="Box-body px-5 pb-5" style="z-index: 1">
                <article class="markdown-body entry-content container-lg"><p>经过前面的折腾，我们已经搭建好了一个初步的媒体影音库，但是有一个致命的缺陷</p>
<p>——**只能在局域网中使用，在外部网络无法随时随地的访问我们的emby/jellyfin服务器。**​~~<strong>我们无法在外面看小姐姐了。</strong>~~</p>
<p>想要解决这个问题，我们可以进行拆分成两个问题并逐个解决：</p>
<ul>
<li>随时访问——一台7×24小时的机器上运行emby</li>
<li>随地访问——利用域名解析/内网穿透等技术进行设备之间互相访问</li>
</ul>
<h1 id="随时访问">随时访问</h1>
<p>NAS（Network Attached Storage）：即网络连接存储，是一种专用的数据存储设备，它以较低的能耗运行，并通过网络文件传输协议实现数据的共享和存储。由nas来当作一个7×24小时不关机的设备是再合适不过了，并且nas本身其实说白了也就是一台电脑，我们依然可以在上面安装emby/jellyfin服务器，这样就实现了一个几乎不关机的影音媒体库了。</p>
<h2 id="搭建思路">搭建思路</h2>
<p>前文所说，nas本质上也就是一台电脑 <strong>（你甚至可以把主力电脑当作nas，只要你的电脑不关机，那就是好nas！）</strong> ，我们像是搭建电脑一样进行选择——成品nas/自建nas。</p>
<h3 id="成品nas">成品nas</h3>
<p>有着较高的售价的缺点，相比起自建nas简直可以说奸商抢钱，但是胜在方便省心，有着较为成熟的系统和靠谱的售后为你形形<strong>色色</strong>的数据保驾护航。</p>
<p><img src="https://easyimage.cyilin.top:10086/i/2025/05/29/12bjo4o-0.png" alt=""></p>
<h3 id="自建nas">自建nas</h3>
<p>虽然比起成品nas，总体价格会便宜不少，可以做到更便宜的价格更高级的配置。但需要跟组装普通电脑一样，我们会进行一系列但不包括买配件进行组装、安装合适的系统等一系列蛋疼的操作，还需要自己承担售后问题，自己对自己的数据负责。</p>
<p>因此，一个合适的搭建方案就尤为重要。</p>
<h2 id="硬件挑选">硬件挑选</h2>
<p>由于本质上我们是搭建一个存储器，因此我们的配置不需要多高，捡一下垃圾足以完成，比如我的配置清单</p>
<table>
  <thead>
      <tr>
          <th>硬件</th>
          <th>配置</th>
          <th>理由</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>CPU</td>
          <td>i3-8100</td>
          <td>带核显可以有效缓解视频解码压力，说不定还能打打小游戏</td>
      </tr>
      <tr>
          <td>内存</td>
          <td>金龙惠宇 8g×4</td>
          <td>个人挂载的服务器有几个挺吃内存的</td>
      </tr>
      <tr>
          <td>主板</td>
          <td>华硕 b360m tuf</td>
          <td>适配cpu就行，最好选项硬盘接口多的</td>
      </tr>
      <tr>
          <td>电源</td>
          <td>长城电源 500w</td>
          <td>玩的就是心跳</td>
      </tr>
      <tr>
          <td>系统盘</td>
          <td>骁麟256GB</td>
          <td>我指存放系统，因此用不着很大</td>
      </tr>
  </tbody>
</table>
<p>以上垃圾配件在二手网/拼多多都可以找到不少好价格，个人花费差不多在800元（<strong>会砍价应该可以做到更低</strong>），相信各位可以找到更具性价比的方案</p>
<p>接着就正常的组装电脑即可，这里就不在赘述，如有不懂，请看vcr：</p>
<p><a href="https://www.bilibili.com/video/BV1BG4y137mG/?vd_source=e216de4d99612620c830e676f0cc9618">【装机教程】全网最好的装机教程，没有之一_哔哩哔哩_bilibili</a></p>
<hr>
<h2 id="安装系统">安装系统</h2>
<p>按照常规步骤，这里应该就是挑选一个成熟的nas系统进行安装，<strong>但</strong>介于windows的GUI之便利和教程数量之多，还有对炸机后数据恢复的考虑，这里我的思路是：</p>
<p><strong>把数据存储在windows上，并在hyper-v虚拟机上运行nas系统，通过SMB网络文件共享，让nas系统可以读取、管理windows上的数据。</strong></p>
<p><del><strong>——就做到Windows GUI我要，小姐姐数据安全我也要。</strong></del></p>
<h3 id="windows的安装">Windows的安装</h3>
<p>首先我们的机器是需要长期开机，因此我们需要一个稳定的windows系统 <del><strong>（时不时偷偷更新的windows是屑）</strong></del> ，这里我选择了WIN11<strong>LTSC</strong>版本（企业版长期服务版本）</p>
<p>对于如何安装windows这里也不多赘述，我相信你们一定会安装。如果真不会，再看vcr：</p>
<p>​<a href="https://www.bilibili.com/video/BV1DJ411D79y/?spm_id_from=888.80997.embed_other.whitelist&amp;t=605.111492&amp;bvid=BV1DJ411D79y&amp;vd_source=e216de4d99612620c830e676f0cc9618">【装机教程】超详细WIN10系统安装教程，官方ISO直装与PE两种方法教程，UEFI+GUID分区与Legacy+MBR分区_哔哩哔哩_bilibili</a>​</p>
<h3 id="设置网络共享">设置网络共享</h3>
<p>点开<code>设置&gt;网络和Internet&gt;高级网络共享设置&gt;高级共享设置</code>，把选项设置为如图所示</p>
<p><img src="https://easyimage.cyilin.top:10086/i/2025/05/29/12bnotn-0.png" alt=""></p>
<p>然后进入<code>本地安全策略&gt;帐户策略&gt;帐户锁定策略</code>，将设置更改为</p>
<p><img src="https://easyimage.cyilin.top:10086/i/2025/05/29/12bnw2t-0.png" alt=""></p>
<p>如此操作可以避免因为权限、密码输入错误等问题导致无法读取数据</p>
<p>接下来，对着我们需要进行共享的文件夹设置为共享：<code>右键属性&gt;共享&gt;选择共享&gt;选择一个用户进行共享（图方便可以选择everyone）</code>​</p>
<p><img src="https://easyimage.cyilin.top:10086/i/2025/05/29/12bnt77-0.png" alt=""></p>
<p>然后选择<code>高级共享&gt;权限&gt;你更改选择的用户</code>，把<code>完全控制</code>勾选上，</p>
<p><img src="https://easyimage.cyilin.top:10086/i/2025/05/29/12bo674-0.png" alt=""></p>
<p>这样，该用户边对这个文件夹拥有完全控制的权限了。</p>
<p>我们可以处于同一局域网的用其他电脑，在<code>文件资源管理器&gt;网络</code>中检测是否可以正确发现你新安装的电脑，接着选择已发现的新电脑，输入你之前选中帐户的用户名和密码访问共享文件夹，并尝试对共享文件夹内进行添加/删除文件测试。</p>
<p>如果没有发现，请在其他电脑的文件资源管理器地址栏路径中输入<code>\\新电脑ip地址</code>（新电脑ip地址可以查看路由器或者在cmd中输入<code>ipconfig</code>来查询），这样就可以顺利的通过网络访问新电脑的共享文件夹了。</p>
<p>‍</p>
<p><strong>至此，Windows的smb设置是告一段落，在这里我们完全其实就可以把这个Windows当作一台win nas来使用了。我们就直接可以把emby等服务放到这台电脑上运行来达成随时访问的效果。</strong></p>
<p>如果你安装的是和我一样的LTSC版本，那可以在<code>设置&gt;系统</code>中把<code>远程桌面</code>打开，然后在主电脑输入新电脑的ip、输入新电脑的帐户密码了远程访问桌面，脱离视频数据线的限制。</p>
<p><img src="https://easyimage.cyilin.top:10086/i/2025/05/29/12bo336-0.png" alt=""></p>
<p><img src="https://easyimage.cyilin.top:10086/i/2025/05/29/12bo0nu-0.png" alt=""></p>
<hr>
<h2 id="hyper-v安装nas系统">Hyper-V安装NAS系统</h2>
<p>虽然前面已经达成了目的，但是我个人认为单纯的靠smb来远程访问文件还是过于粗糙了，因此还是用虚拟机的方式安装一个nas系统，以此达成更方便管理数据的目的。</p>
<h3 id="安装hyper-v">安装Hyper-v</h3>
<p><a href="https://learn.microsoft.com/zh-cn/virtualization/hyper-v-on-windows/quick-start/enable-hyper-v">在 Windows 和 Windows Server 中安装 Hyper-V | Microsoft Learn</a></p>
<p>管理员身份打开<strong>powershell</strong>并输入<code>Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V -All</code>等待下载安装完毕。</p>
<h3 id="安装nas系统">安装NAS系统</h3>
<p>我这里选择最近还挺火的<a href="https://www.fnnas.com/">飞牛OS</a>进行安装。我们进入<a href="https://www.fnnas.com/download">下载</a>页面下载最新的固件，保存在新电脑的硬盘内。然后打开Hyper-V管理器，选择<code>虚拟交换机管理器</code>​</p>
<p><img src="https://easyimage.cyilin.top:10086/i/2025/05/29/12bo3jq-0.png" alt=""></p>
<p>然后选择<code>新建虚拟网络交换机&gt;外部&gt;建立虚拟交换机</code>​</p>
<p><img src="https://easyimage.cyilin.top:10086/i/2025/05/29/12boc0y-0.png" alt=""></p>
<p>选择你的网卡，然后点击<code>确认</code>即可</p>
<p><img src="https://easyimage.cyilin.top:10086/i/2025/05/29/12bocc7-0.png" alt=""></p>
<p>这一步是建立一个虚拟交换机，让真实的物理网卡连接在交换机上，宿主机和fnos则是通过虚拟交换机间接和物理网卡链接在一起，这样宿主机和fnos就在网络上是同一个层级，方便我们后面用其他设备用浏览器去登录处于hyper-v中的fnos。</p>
<p>下一步选择<code>新建&gt;虚拟机</code>​</p>
<p><img src="https://easyimage.cyilin.top:10086/i/2025/05/29/12bocz1-0.png" alt=""></p>
<p>名称随意，指定代数选择第一代</p>
<p><img src="https://easyimage.cyilin.top:10086/i/2025/05/29/12bobqw-0.png" alt=""></p>
<p>内存分配按需分配，只是单纯做数据管理的不在上面挂载服务，4GB绰绰有余。分配网络选择你刚刚建立好的虚拟网络交换机，连接虚拟机硬盘不知道的话就默认即可，安装选项选择<code>从可启动的 CD/DVD-ROM 安装操作系统</code>并选中下载好的固件</p>
<p>​<img src="https://easyimage.cyilin.top:10086/i/2025/05/29/12bomtj-0.png" alt=""></p>
<p>最后配置选择如图所示</p>
<p>​<img src="https://easyimage.cyilin.top:10086/i/2025/05/29/12bogg5-0.png" alt=""></p>
<p>这样我们成功就建立了一个虚拟机。接下来双击新建立的虚拟机，选择<code>启动</code>，按照提示一步一步操作即可安装好虚拟机，最后在浏览器（只要在同一局域网内的设备即可）输入<strong>红框中的地址</strong>即可进入到飞机OS中，完成初始化的设置</p>
<p><img src="https://easyimage.cyilin.top:10086/i/2025/05/29/12bohfq-0.png" alt=""></p>
<h3 id="飞牛os读取windows-smb共享文件夹">飞牛OS读取Windows smb共享文件夹</h3>
<p>此时我们在浏览器进入飞牛os，点击<code>文件管理&gt;远程挂载&gt;挂载远程文件夹&gt;smb</code>，把信息填写完整即可。</p>
<p><img src="https://easyimage.cyilin.top:10086/i/2025/05/29/12bor7a-0.png" alt=""></p>
<p><img src="https://easyimage.cyilin.top:10086/i/2025/05/29/12bor7a-0.png" alt=""></p>
<p><strong>这样，在飞牛中进入</strong>​<code>文件管理&gt;远程挂载&gt;挂载远程文件夹</code>​ <strong>，双击挂载的文件夹便可以管理共享文件夹，在飞牛的手机端上也可以看到挂载的远程文件夹了。</strong></p>
<hr>
<h3 id="飞牛os中安装emby">飞牛OS中安装EMBY</h3>
<p>如果不想要在Windows中挂载emby，也可以选择在飞牛中挂载，个人建议选择<strong>应用中心</strong>的emby</p>
<p>​<img src="https://easyimage.cyilin.top:10086/i/2025/05/29/12bor7y-0.png" alt=""></p>
<p>当然<strong>docker</strong>中的也可以</p>
<p><img src="https://easyimage.cyilin.top:10086/i/2025/05/29/12bopki-0.png" alt=""></p>
<p><strong>但，有现成的为什么不用现成的呢？</strong></p>
<p>安装教程可以参考前篇。</p>
<p>需要注意的是在<strong>新建媒体库</strong>的时候，把<strong>文件夹</strong>的路径选择<code>网络</code>​</p>
<p><img src="https://easyimage.cyilin.top:10086/i/2025/05/29/12bozcn-0.png" alt=""></p>
<p>然后选择你<strong>新电脑</strong>的<code>ip地址</code>，并选择路径即可。</p>
</article>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
<script type="application/javascript" src='https://cyilin36.github.io/js/toc.js'></script>
<link rel="stylesheet" href='https://cyilin36.github.io/css/toc.css' />

  
</div>

  
</body>

<script type="application/javascript" src="https://cyilin36.github.io/js/github-style.js"></script>





<script src="https://cdn.jsdelivr.net/npm/fuse.js/dist/fuse.min.js"></script>
<script type="application/javascript" src='https://cyilin36.github.io/js/search.js'></script>



</html>